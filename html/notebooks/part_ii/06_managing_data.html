
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y6ZQJ0S1M2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y6ZQJ0S1M2');
</script>
    
    
    <title>Managing textual data using pandas</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Part III: Natural Language Processing for Linguists" href="../../nlp_for_linguists.html" />
    <link rel="prev" title="Evaluating language models" href="05_evaluating_nlp.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about.html">
   About this MOOC
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../getting_started.html">
   Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notebook_login.html">
     Log in to CSC Notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../launch_server.html">
     Launch a server on CSC Notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../jupyter.html">
     Interact with the server in JupyterLab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tmc.html">
     Check your exercises using TestMyCode
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../faq.html">
   Frequently Asked Questions
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../python_intro.html">
   Part I: A Minimal Introduction to Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../part_i/01_working_with_jupyter_notebooks.html">
     The elements of a Jupyter Notebook
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../part_i/02_getting_started_with_python.html">
     Getting started with Python
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../working_with_text.html">
   Part II: Working with Text in Python
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_basic_text_processing.html">
     Manipulating text using Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_basic_text_processing_continued.html">
     Manipulating text at scale
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_basic_nlp.html">
     Processing texts using spaCy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_basic_nlp_continued.html">
     Customising the spaCy pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05_evaluating_nlp.html">
     Evaluating language models
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Managing textual data using pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../nlp_for_linguists.html">
   Part III: Natural Language Processing for Linguists
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../part_iii/01_multilingual_nlp.html">
     Processing diverse languages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../part_iii/02_universal_dependencies.html">
     Universal Dependencies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../part_iii/03_pattern_matching.html">
     Finding linguistic patterns using spaCy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../part_iii/04_embeddings.html">
     Introducing word embeddings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../part_iii/05_embeddings_continued.html">
     Word embeddings in spaCy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../part_iii/06_text_linguistics.html">
     Working with discourse-level annotations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../citation.html">
   Citation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources.html">
   Resources
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/Applied-Language-Technology/website/binder?urlpath=lab/tree/notebooks/part_ii/06_managing_data.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/Applied-Language-Technology/website"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/notebooks/part_ii/06_managing_data.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-data-to-pandas">
   Importing data to pandas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-data-from-a-single-file">
     Importing data from a single file
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-data-from-multiple-files">
     Importing data from multiple files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examining-dataframes">
   Examining DataFrames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extending-dataframes">
   Extending DataFrames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-dataframes">
   Saving DataFrames
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Managing textual data using pandas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-data-to-pandas">
   Importing data to pandas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-data-from-a-single-file">
     Importing data from a single file
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-data-from-multiple-files">
     Importing data from multiple files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examining-dataframes">
   Examining DataFrames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extending-dataframes">
   Extending DataFrames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-dataframes">
   Saving DataFrames
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="managing-textual-data-using-pandas">
<h1>Managing textual data using pandas<a class="headerlink" href="#managing-textual-data-using-pandas" title="Permalink to this headline">#</a></h1>
<p>This section introduces how to prepare and manage textual data for analysis using <a class="reference external" href="http://pandas.pydata.org/">pandas</a>, a Python library for working with tabular data.</p>
<p>After reading this section, you should know:</p>
<ul class="simple">
<li><p>how to import data into a pandas DataFrame</p></li>
<li><p>how to explore data stored in a pandas DataFrame</p></li>
<li><p>how to append data to a pandas DataFrame</p></li>
<li><p>how to save the data in a pandas DataFrame</p></li>
</ul>
<section id="importing-data-to-pandas">
<h2>Importing data to pandas<a class="headerlink" href="#importing-data-to-pandas" title="Permalink to this headline">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="600"
            height="350"
            src="https://www.youtube.com/embed/UQYyCVGZbvk"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>Let’s start by importing the pandas library.</p>
<p>Note that we can control the name of the imported module using the <code class="docutils literal notranslate"><span class="pre">as</span></code> addition to the <code class="docutils literal notranslate"><span class="pre">import</span></code> command. pandas is commonly abbreviated <code class="docutils literal notranslate"><span class="pre">pd</span></code>.</p>
<p>This allows us to use the variable <code class="docutils literal notranslate"><span class="pre">pd</span></code> to refer to the <em>pandas</em> library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="importing-data-from-a-single-file">
<h3>Importing data from a single file<a class="headerlink" href="#importing-data-from-a-single-file" title="Permalink to this headline">#</a></h3>
<p>You must often load and prepare the data yourself, either from a single file or from multiple files.</p>
<p>Typical formats for distributing corpora include CSV files, which stands for Comma-separated Values, and JSON, which stands for JavaScript Object Notation or simple plain text files.</p>
<p>pandas provides plenty of functions for <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html">reading data in various formats</a>. You can even try importing Excel sheets!</p>
<p>The following example shows how to load a corpus from a CSV file for processing in Python using the <a class="reference external" href="https://github.com/sfu-discourse-lab/SOCC">SFU Opinion and Comments Corpus (SOCC)</a> (Kolhatkar et al. <a class="reference external" href="https://doi.org/10.1007/s41701-019-00065-w">2020</a>).</p>
<p>Let’s load a part of the SFU Opinion and Comments Corpus, which contains the opinion articles from <a class="reference external" href="https://www.theglobeandmail.com/">The Globe and Mail</a>, a Canadian newspaper.</p>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> function from pandas to read files with comma-separated values, such as the SOCC corpus.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> function takes a string object as input, which defines a path to the input file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the CSV file and assign the output to the variable &#39;socc&#39;</span>
<span class="n">socc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/socc_gnm_articles.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>pandas does all the heavy lifting and returns the contents of the CSV file in a pandas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">DataFrame</a>, which is data structure native to pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the type of the object stored under the variable &#39;socc&#39;</span>
<span class="nb">type</span><span class="p">(</span><span class="n">socc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
</div>
<p>Let’s use the <code class="docutils literal notranslate"><span class="pre">head()</span></code> method of a DataFrame to check out the first five rows of the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the first five rows of the DataFrame</span>
<span class="n">socc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26842506</td>
      <td>The Tories deserve another mandate - Stephen H...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2015-10-16 EDT</td>
      <td>2187.0</td>
      <td>1378.0</td>
      <td>&lt;p&gt;All elections are choices among imperfect a...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26055892</td>
      <td>Harper hysteria a sign of closed liberal minds</td>
      <td>http://www.theglobeandmail.com/opinion/harper-...</td>
      <td>Konrad Yakabuski</td>
      <td>2015-08-24 EDT</td>
      <td>1103.0</td>
      <td>455.0</td>
      <td>&lt;p&gt;If even a fraction of the darkness that his...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6929035</td>
      <td>Too many first nations people live in a dream ...</td>
      <td>http://www.theglobeandmail.com/opinion/too-man...</td>
      <td>Jeffrey Simpson</td>
      <td>2013-01-05 EST</td>
      <td>1164.0</td>
      <td>433.0</td>
      <td>&lt;p&gt;Large elements of aboriginal Canada live in...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19047636</td>
      <td>The Globe's editorial board endorses Tim Hudak...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2014-06-06 EDT</td>
      <td>905.0</td>
      <td>432.0</td>
      <td>&lt;p&gt;Over four days, The Globe editorial board l...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11672346</td>
      <td>Disgruntled Arab states look to strip Canada o...</td>
      <td>http://www.theglobeandmail.com/news/world/disg...</td>
      <td>Campbell Clark</td>
      <td>2013-05-02 EDT</td>
      <td>1129.0</td>
      <td>411.0</td>
      <td>&lt;p&gt;Growing discontent among Arab nations over ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, the DataFrame has a tabular form.</p>
<p>The DataFrame contains several columns such as <strong>article_id</strong>, <strong>title</strong> and <strong>article_text</strong>, accompanied by an index for each row (<strong>0, 1, 2, 3, 4</strong>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.at[]</span></code> accessor can be used to inspect a single item in the DataFrame.</p>
<p>Let’s examine the value in the column <strong>title</strong> at index 123.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">socc</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;How Toronto got a &#39;world-class,&#39; gold-plated, half-billion-dollar empty train&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="importing-data-from-multiple-files">
<h3>Importing data from multiple files<a class="headerlink" href="#importing-data-from-multiple-files" title="Permalink to this headline">#</a></h3>
<p>Another common scenario is that you have multiple files with text data, which you want to load into <em>pandas</em>.</p>
<p>Let’s first collect the files that we want to load.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the patch library</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Create a Path object that points to the directory with data</span>
<span class="n">corpus_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="c1"># Get all .txt files in the corpus directory</span>
<span class="n">corpus_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">corpus_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.txt&#39;</span><span class="p">))</span>

<span class="c1"># Check the corpus files</span>
<span class="n">corpus_files</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[PosixPath(&#39;data/WP_1990-08-10-25A.txt&#39;),
 PosixPath(&#39;data/NYT_1991-01-16-A15.txt&#39;),
 PosixPath(&#39;data/WP_1991-01-17-A1B.txt&#39;)]
</pre></div>
</div>
</div>
</div>
<p>To accommodate our data, let’s create an empty pandas DataFrame and specify its <em>shape</em> in advance, that is, the number of rows (<code class="docutils literal notranslate"><span class="pre">index</span></code>) and the names of the columns <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p>
<p>We can determine the number of rows needed using Python’s <code class="docutils literal notranslate"><span class="pre">range()</span></code> function. This function generates a list of numbers that fall within certain range, which we can use for the index of the DataFrame.</p>
<p>In this case, we define a <code class="docutils literal notranslate"><span class="pre">range()</span></code> between <code class="docutils literal notranslate"><span class="pre">0</span></code> and the number of text files in the directory, which are stored under the variable <code class="docutils literal notranslate"><span class="pre">corpus_files</span></code>. We retrieve their number using the <code class="docutils literal notranslate"><span class="pre">len()</span></code> function, which returns the length of Python objects, if applicable.</p>
<p>For the columns of the DataFrame, we simply create columns for filenames and their textual content by providing a list of strings to the <code class="docutils literal notranslate"><span class="pre">columns</span></code> argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a DataFrame and assign the result to the variable &#39;df&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corpus_files</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">])</span>

<span class="c1"># Call the variable to inspect the output</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now that we have an empty data with rows for each file in the corpus, we can loop over the <em>Path</em> objects under <code class="docutils literal notranslate"><span class="pre">corpus_files</span></code>, read their contents and add them to the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop over the corpus files and count each loop using enumerate()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corpus_files</span><span class="p">):</span>
    
    <span class="c1"># Read the file contents</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read_text</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    
    <span class="c1"># Get the filename from the Path object</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># Assign the text from the file to index &#39;i&#39; at column &#39;text&#39;</span>
    <span class="c1"># using the .at accessor – note that this modifies the DataFrame</span>
    <span class="c1"># &quot;in place&quot; – you don&#39;t need to assign the result into a variable</span>
    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
    
    <span class="c1"># We then do the same to the filename</span>
    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s check the result by calling the variable <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Call the variable to check the output</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WP_1990-08-10-25A.txt</td>
      <td>﻿*We Don’t Stand for Bullies': Diverse Voices ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NYT_1991-01-16-A15.txt</td>
      <td>﻿U.S. TAKING STEPS TO CURB TERRORISM: F.B.I. I...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WP_1991-01-17-A1B.txt</td>
      <td>﻿U.S., Allies Launch Massive Air War Against T...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, the DataFrame has been populated with filenames and text.</p>
<p>Now that we know how to load data into DataFrames, we can turn towards accessing and manipulating the data that they store.</p>
</section>
</section>
<section id="examining-dataframes">
<h2>Examining DataFrames<a class="headerlink" href="#examining-dataframes" title="Permalink to this headline">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="600"
            height="350"
            src="https://www.youtube.com/embed/-zhW3YjhuzI"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>pandas DataFrames can hold a lot of information, which is often organised into columns.</p>
<p>The columns present in a DataFrame are accessible through the attribute <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve the columns and their names</span>
<span class="n">socc</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;article_id&#39;, &#39;title&#39;, &#39;article_url&#39;, &#39;author&#39;, &#39;published_date&#39;,
       &#39;ncomments&#39;, &#39;ntop_level_comments&#39;, &#39;article_text&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>pandas provides various methods for examining the contents of entire columns, which can be accessed just like the keys and values of a Python dictionary.</p>
<p>The brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code> can be used to access entire columns by placing the column name within the brackets as a string.</p>
<p>Let’s retrieve the contents of the column <code class="docutils literal notranslate"><span class="pre">author</span></code>, which contains author information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve the contents of the column &#39;author&#39; in the DataFrame &#39;socc&#39;</span>
<span class="n">socc</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         GLOBE EDITORIAL
1        Konrad Yakabuski
2         Jeffrey Simpson
3         GLOBE EDITORIAL
4          Campbell Clark
               ...       
10334     GLOBE EDITORIAL
10335     GLOBE EDITORIAL
10336     GLOBE EDITORIAL
10337      Adam Radwanski
10338     GLOBE EDITORIAL
Name: author, Length: 10339, dtype: object
</pre></div>
</div>
</div>
</div>
<p>As you can see, the column <code class="docutils literal notranslate"><span class="pre">author</span></code> contains 10399 objects, as indicated by the <em>Length</em> and <em>dtype</em> properties. The numbers on the left-hand side give the index, that is, the row numbers.</p>
<p>The columns of a pandas DataFrame consist of another object type, namely <em>pandas</em> Series. You can think of the DataFrame as an entire table, whose columns consist of Series.</p>
<p>We can verify this by examining their type using Python’s <code class="docutils literal notranslate"><span class="pre">type()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the type of &#39;socc&#39; and &#39;socc[&#39;author&#39;]&#39;</span>
<span class="nb">type</span><span class="p">(</span><span class="n">socc</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">socc</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(pandas.core.frame.DataFrame, pandas.core.series.Series)
</pre></div>
</div>
</div>
</div>
<p>When printing out the contents of a DataFrame or Series, pandas omits everything between the first and last five rows by default. This is convenient when working with thousands of rows.</p>
<p>This also applies to the output for methods such as <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code>, which allows counting the number of unique values in a Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count unique values in the column &#39;author&#39;</span>
<span class="n">socc</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GLOBE EDITORIAL                   2712
Jeffrey Simpson                    649
Margaret Wente                     547
Konrad Yakabuski                   404
Gary Mason                         365
                                  ... 
MARK MATTSON AND KRYSTYN TULLY       1
KEVIN LACEY                          1
Adrian Morrow                        1
Jessica Scott-Reid                   1
Kenneth Oppel                        1
Name: author, Length: 1896, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Not surprisingly, the editorial team at the <em>The Globe and Mail</em> is responsible for most of the editorials!</p>
<p>Let’s take another look at the data by visualising the result by calling the <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method for the author information column. This method calls an external library named matplotlib, which can be used to produce all kinds of plots and visualisations.</p>
<p>More specifically, we instruct the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> method to draw a bar chart by providing the string <code class="docutils literal notranslate"><span class="pre">bar</span></code> to the <code class="docutils literal notranslate"><span class="pre">kind</span></code> argument.</p>
<p>We also use the brackets <code class="docutils literal notranslate"><span class="pre">[:10]</span></code> to limit the output to the ten most profilic authors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is some Jupyter magic that allows us to render matplotlib plots in the notebooks!</span>
<span class="c1"># You only need to enter this command once.</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Count the values in the column &#39;author&#39; and clip the result to top-10 before plotting.</span>
<span class="n">socc</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: &gt;
</pre></div>
</div>
<img alt="../../_images/b4663523045a83348c73f302a9bae1912c81626ed83d2eb1aed06af645660467.png" src="../../_images/b4663523045a83348c73f302a9bae1912c81626ed83d2eb1aed06af645660467.png" />
</div>
</div>
<p>For columns with numerical values, we can also use the <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method to get basic descriptive statistics on the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get basic descriptive statistics for the column &#39;ntop_level_comments&#39;</span>
<span class="n">socc</span><span class="p">[</span><span class="s1">&#39;ntop_level_comments&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    10339.000000
mean        26.384273
std         39.786923
min          0.000000
25%          1.000000
50%         14.000000
75%         35.000000
max       1378.000000
Name: ntop_level_comments, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As we can see, the column <code class="docutils literal notranslate"><span class="pre">ntop_level_comments</span></code> has a total of 10339 rows.</p>
<p>The average number of comments received by an editorial is approximately 26, but this number fluctuates, as the standard deviation from the average is nearly 40.</p>
<ul class="simple">
<li><p>Some editorials do not have any comments at all, as indicated by the minimum value of 0.</p></li>
<li><p>The lowest quartile shows that 25% of the data has only one comment or less (none).</p></li>
<li><p>The second quartile (50%), which is also known as the median, indicates that <em>half</em> of the data has less than 14 comments and <em>half</em> has more than 14 comments.</p></li>
<li><p>The third quartile shows that 75% of the data has 35 comments or less.</p></li>
<li><p>The most commented editorial has 1378 comments.</p></li>
</ul>
<p>What if we would like to find the articles with zero comments?</p>
<p>We can use the DataFrame accessor <code class="docutils literal notranslate"><span class="pre">.loc</span></code> to access specific rows based on their values.</p>
<p>The number of comments is stored in the column <code class="docutils literal notranslate"><span class="pre">ntop_level_comments</span></code>, but we also need to specify that the DataFrame stored under the variable <code class="docutils literal notranslate"><span class="pre">socc</span></code> contains the column that we wish to examine.</p>
<p>This causes the somewhat repetitive reference to the <code class="docutils literal notranslate"><span class="pre">socc</span></code> DataFrame, which is nevertheless necessary for being explicit.</p>
<p>We also need to provide a command for “is equal to”. Since the single equal sign <code class="docutils literal notranslate"><span class="pre">=</span></code> is reserved for assigning variables in Python, two equal signs <code class="docutils literal notranslate"><span class="pre">==</span></code> are used for comparison.</p>
<p>Finally, we place the value we want to evaluate against on the right-hand side of the double equal sign <code class="docutils literal notranslate"><span class="pre">==</span></code>, that is, zero for no comments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get rows with no top level comments</span>
<span class="n">socc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">socc</span><span class="p">[</span><span class="s1">&#39;ntop_level_comments&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7797</th>
      <td>33441604</td>
      <td>Joseph Boyden, where are you from?</td>
      <td>http://www.theglobeandmail.com/opinion/joseph-...</td>
      <td>Hayden King</td>
      <td>2016-12-28 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;Hayden King teaches in the School of Public...</td>
    </tr>
    <tr>
      <th>7798</th>
      <td>33316285</td>
      <td>Globe editorial: Rejoice! Congress just gave t...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2016-12-13 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;The United States may have just elected a p...</td>
    </tr>
    <tr>
      <th>7799</th>
      <td>33009790</td>
      <td>Police and La Presse: Warrants not warranted</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2016-11-23 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;The discovery that the Montreal Police obta...</td>
    </tr>
    <tr>
      <th>7800</th>
      <td>32970624</td>
      <td>The Galloway affair: Salem comes to UBC</td>
      <td>http://www.theglobeandmail.com/opinion/the-gal...</td>
      <td>Margaret Wente</td>
      <td>2016-11-22 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;I have a question about the Steven Galloway...</td>
    </tr>
    <tr>
      <th>7801</th>
      <td>32927142</td>
      <td>Justice delayed: the law of unintended consequ...</td>
      <td>http://www.theglobeandmail.com/opinion/unreaso...</td>
      <td>BENJAMIN PERRIN</td>
      <td>2016-11-19 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;Benjamin Perrin is a law professor at the U...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10334</th>
      <td>533784</td>
      <td>WTO action on China's rare-earth quotas makes ...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2012-03-14 EDT</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;The confusingly named substances known as '...</td>
    </tr>
    <tr>
      <th>10335</th>
      <td>533594</td>
      <td>A customer-friendly Finance Department</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2012-03-13 EDT</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;Of the many things that frustrate the retai...</td>
    </tr>
    <tr>
      <th>10336</th>
      <td>533508</td>
      <td>Video raises questions about Nik Zoricic's 'fr...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2012-03-12 EDT</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;Officials and fans are mourning the death o...</td>
    </tr>
    <tr>
      <th>10337</th>
      <td>533504</td>
      <td>McGuinty can't afford misgivings about gaming</td>
      <td>http://www.theglobeandmail.com/news/politics/m...</td>
      <td>Adam Radwanski</td>
      <td>2012-03-12 EDT</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;Unlike so many of the other measures that m...</td>
    </tr>
    <tr>
      <th>10338</th>
      <td>533471</td>
      <td>In Russia, Canada should look for investment, ...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2012-03-12 EDT</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;As if in swift response to Prime Minister V...</td>
    </tr>
  </tbody>
</table>
<p>2542 rows × 8 columns</p>
</div></div></div>
</div>
<p>This returns a total of 2542 rows where the value of the column <code class="docutils literal notranslate"><span class="pre">ntop_level_comments</span></code> is zero.</p>
<p>For more complex views of the data, we can also combine multiple criteria using the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> symbol, which is the Python operator for “AND”.</p>
<p>Note that individual criteria must be placed in parentheses <code class="docutils literal notranslate"><span class="pre">()</span></code> to perform the operation.</p>
<p>Let’s check if the first author in our result, Hayden King, wrote any other articles with zero comments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get number of top level comments for author Hayden King</span>
<span class="n">socc</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">socc</span><span class="p">[</span><span class="s1">&#39;ntop_level_comments&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">socc</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Hayden King&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7797</th>
      <td>33441604</td>
      <td>Joseph Boyden, where are you from?</td>
      <td>http://www.theglobeandmail.com/opinion/joseph-...</td>
      <td>Hayden King</td>
      <td>2016-12-28 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;Hayden King teaches in the School of Public...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="extending-dataframes">
<h2>Extending DataFrames<a class="headerlink" href="#extending-dataframes" title="Permalink to this headline">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="600"
            height="350"
            src="https://www.youtube.com/embed/Yj87Gy28vqs"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>You can easily add information to pandas DataFrames.</p>
<p>One common scenario could involve loading some data from an external file (such as a CSV or JSON file), performing some analyses and storing the results to the same DataFrame.</p>
<p>We can easily add an empty column to the DataFrame. This is achieved using the column accessor <code class="docutils literal notranslate"><span class="pre">[]</span></code> and the Python datatype <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Let’s add a new column named <code class="docutils literal notranslate"><span class="pre">comments_ratio</span></code> to the DataFrame <code class="docutils literal notranslate"><span class="pre">socc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a new column named &#39;comments_ratio&#39; to the DataFrame</span>
<span class="n">socc</span><span class="p">[</span><span class="s1">&#39;comments_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the first five rows of the DataFrame</span>
<span class="n">socc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
      <th>comments_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26842506</td>
      <td>The Tories deserve another mandate - Stephen H...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2015-10-16 EDT</td>
      <td>2187.0</td>
      <td>1378.0</td>
      <td>&lt;p&gt;All elections are choices among imperfect a...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26055892</td>
      <td>Harper hysteria a sign of closed liberal minds</td>
      <td>http://www.theglobeandmail.com/opinion/harper-...</td>
      <td>Konrad Yakabuski</td>
      <td>2015-08-24 EDT</td>
      <td>1103.0</td>
      <td>455.0</td>
      <td>&lt;p&gt;If even a fraction of the darkness that his...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6929035</td>
      <td>Too many first nations people live in a dream ...</td>
      <td>http://www.theglobeandmail.com/opinion/too-man...</td>
      <td>Jeffrey Simpson</td>
      <td>2013-01-05 EST</td>
      <td>1164.0</td>
      <td>433.0</td>
      <td>&lt;p&gt;Large elements of aboriginal Canada live in...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19047636</td>
      <td>The Globe's editorial board endorses Tim Hudak...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2014-06-06 EDT</td>
      <td>905.0</td>
      <td>432.0</td>
      <td>&lt;p&gt;Over four days, The Globe editorial board l...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11672346</td>
      <td>Disgruntled Arab states look to strip Canada o...</td>
      <td>http://www.theglobeandmail.com/news/world/disg...</td>
      <td>Campbell Clark</td>
      <td>2013-05-02 EDT</td>
      <td>1129.0</td>
      <td>411.0</td>
      <td>&lt;p&gt;Growing discontent among Arab nations over ...</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s populate the column with some data by calculating which percentage of the comments are top-level comments, assuming that a high percentage of top-level comments indicates comments about the article, whereas a lower percentage indicates more discussion about the comments posted.</p>
<p>To get the proportion of top-level comments out of all comments, we must divide the number of top-level comments by the number of all comments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Populate the &#39;comments_ratio&#39; column by calculating the ratio of top-level comments and comments</span>
<span class="n">socc</span><span class="p">[</span><span class="s1">&#39;comments_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">socc</span><span class="p">[</span><span class="s1">&#39;ntop_level_comments&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">socc</span><span class="p">[</span><span class="s1">&#39;ncomments&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Column accessors can be used very flexibly to access and manipulate data stored in the DataFrame, as exemplified by the division.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the first five rows of the DataFrame</span>
<span class="n">socc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
      <th>comments_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26842506</td>
      <td>The Tories deserve another mandate - Stephen H...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2015-10-16 EDT</td>
      <td>2187.0</td>
      <td>1378.0</td>
      <td>&lt;p&gt;All elections are choices among imperfect a...</td>
      <td>0.630087</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26055892</td>
      <td>Harper hysteria a sign of closed liberal minds</td>
      <td>http://www.theglobeandmail.com/opinion/harper-...</td>
      <td>Konrad Yakabuski</td>
      <td>2015-08-24 EDT</td>
      <td>1103.0</td>
      <td>455.0</td>
      <td>&lt;p&gt;If even a fraction of the darkness that his...</td>
      <td>0.412511</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6929035</td>
      <td>Too many first nations people live in a dream ...</td>
      <td>http://www.theglobeandmail.com/opinion/too-man...</td>
      <td>Jeffrey Simpson</td>
      <td>2013-01-05 EST</td>
      <td>1164.0</td>
      <td>433.0</td>
      <td>&lt;p&gt;Large elements of aboriginal Canada live in...</td>
      <td>0.371993</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19047636</td>
      <td>The Globe's editorial board endorses Tim Hudak...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2014-06-06 EDT</td>
      <td>905.0</td>
      <td>432.0</td>
      <td>&lt;p&gt;Over four days, The Globe editorial board l...</td>
      <td>0.477348</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11672346</td>
      <td>Disgruntled Arab states look to strip Canada o...</td>
      <td>http://www.theglobeandmail.com/news/world/disg...</td>
      <td>Campbell Clark</td>
      <td>2013-05-02 EDT</td>
      <td>1129.0</td>
      <td>411.0</td>
      <td>&lt;p&gt;Growing discontent among Arab nations over ...</td>
      <td>0.364039</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, the column <code class="docutils literal notranslate"><span class="pre">comments_ratio</span></code> now stores the result of our calculation!</p>
<p>However, we should also keep in mind that some articles did not receive any comments at all: thus we would have divided zero by zero.</p>
<p>Let’s examine these cases again by retrieving articles without comments, and use the <code class="docutils literal notranslate"><span class="pre">head()</span></code> method to limit the output to the first five rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the first five comments with no top-level comments</span>
<span class="n">socc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">socc</span><span class="p">[</span><span class="s1">&#39;ntop_level_comments&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
      <th>comments_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7797</th>
      <td>33441604</td>
      <td>Joseph Boyden, where are you from?</td>
      <td>http://www.theglobeandmail.com/opinion/joseph-...</td>
      <td>Hayden King</td>
      <td>2016-12-28 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;Hayden King teaches in the School of Public...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7798</th>
      <td>33316285</td>
      <td>Globe editorial: Rejoice! Congress just gave t...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2016-12-13 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;The United States may have just elected a p...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7799</th>
      <td>33009790</td>
      <td>Police and La Presse: Warrants not warranted</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2016-11-23 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;The discovery that the Montreal Police obta...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7800</th>
      <td>32970624</td>
      <td>The Galloway affair: Salem comes to UBC</td>
      <td>http://www.theglobeandmail.com/opinion/the-gal...</td>
      <td>Margaret Wente</td>
      <td>2016-11-22 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;I have a question about the Steven Galloway...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7801</th>
      <td>32927142</td>
      <td>Justice delayed: the law of unintended consequ...</td>
      <td>http://www.theglobeandmail.com/opinion/unreaso...</td>
      <td>BENJAMIN PERRIN</td>
      <td>2016-11-19 EST</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>&lt;p&gt;Benjamin Perrin is a law professor at the U...</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For these rows, the <code class="docutils literal notranslate"><span class="pre">comments_ratio</span></code> column contains values marked as <code class="docutils literal notranslate"><span class="pre">NaN</span></code> or “not a number”.</p>
<p>This indicates that the division was performed on these cells as well, but the result was not a number.</p>
<p><em>pandas</em> automatically ignores <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values when performing calculations, as show by the <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get descriptive statistics for the column &#39;comments_ratio&#39;</span>
<span class="n">socc</span><span class="p">[</span><span class="s1">&#39;comments_ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    7797.000000
mean        0.537057
std         0.205398
min         0.083333
25%         0.384615
50%         0.485714
75%         0.647059
max         1.000000
Name: comments_ratio, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Note the difference in the result for the count. Only 7797 items out of 10399 were included in the calculation.</p>
<p>What if we would like to do some natural language processing and store the results in the DataFrame?</p>
<p>Let’s select articles that fall within the first quartile in terms of the ratio of original comments to all comments made (<code class="docutils literal notranslate"><span class="pre">comments_ratio</span></code>) and have received more than 200 comments (<code class="docutils literal notranslate"><span class="pre">ncomments</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter the DataFrame for highly commented articles and assign the result to the variable &#39;talk&#39;</span>
<span class="n">talk</span> <span class="o">=</span> <span class="n">socc</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">socc</span><span class="p">[</span><span class="s1">&#39;comments_ratio&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.384</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">socc</span><span class="p">[</span><span class="s1">&#39;ncomments&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">200</span><span class="p">)]</span>

<span class="c1"># Call the variable to examine the output</span>
<span class="n">talk</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
      <th>comments_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>6929035</td>
      <td>Too many first nations people live in a dream ...</td>
      <td>http://www.theglobeandmail.com/opinion/too-man...</td>
      <td>Jeffrey Simpson</td>
      <td>2013-01-05 EST</td>
      <td>1164.0</td>
      <td>433.0</td>
      <td>&lt;p&gt;Large elements of aboriginal Canada live in...</td>
      <td>0.371993</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11672346</td>
      <td>Disgruntled Arab states look to strip Canada o...</td>
      <td>http://www.theglobeandmail.com/news/world/disg...</td>
      <td>Campbell Clark</td>
      <td>2013-05-02 EDT</td>
      <td>1129.0</td>
      <td>411.0</td>
      <td>&lt;p&gt;Growing discontent among Arab nations over ...</td>
      <td>0.364039</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26691065</td>
      <td>Fifty years in Canada, and now I feel like a s...</td>
      <td>http://www.theglobeandmail.com/opinion/fifty-y...</td>
      <td>SHEEMA KHAN</td>
      <td>2015-10-07 EDT</td>
      <td>1142.0</td>
      <td>376.0</td>
      <td>&lt;p&gt;'Too broken to write,' I told my editor, af...</td>
      <td>0.329247</td>
    </tr>
    <tr>
      <th>6</th>
      <td>25731634</td>
      <td>I'm Canadian - and I should have a right to vote</td>
      <td>http://www.theglobeandmail.com/opinion/im-cana...</td>
      <td>Donald Sutherland</td>
      <td>2015-07-28 EDT</td>
      <td>1021.0</td>
      <td>348.0</td>
      <td>&lt;p&gt;My name is Donald Sutherland. My wife's nam...</td>
      <td>0.340842</td>
    </tr>
    <tr>
      <th>8</th>
      <td>13647608</td>
      <td>A nation of $100,000 firefighters</td>
      <td>http://www.theglobeandmail.com/opinion/a-natio...</td>
      <td>Margaret Wente</td>
      <td>2013-08-08 EDT</td>
      <td>1102.0</td>
      <td>338.0</td>
      <td>&lt;p&gt;Everyone loves firefighters. They save live...</td>
      <td>0.306715</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s import spaCy, load a medium-sized language model for English and assign this model to the variable <code class="docutils literal notranslate"><span class="pre">nlp</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the spaCy library</span>
<span class="kn">import</span> <span class="nn">spacy</span>

<span class="c1"># Note that we now load a medium-sized language model!</span>
<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en_core_web_md&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s limit processing to article titles and create a placeholder column to the DataFrame named <code class="docutils literal notranslate"><span class="pre">processed_title</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new column named &#39;processed_title&#39;</span>
<span class="n">talk</span><span class="p">[</span><span class="s1">&#39;processed_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/qw/3f1xq85n6vl73ksgmtslw2_mzhdr7p/T/ipykernel_13682/1354777276.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  talk[&#39;processed_title&#39;] = None
</pre></div>
</div>
</div>
</div>
<p>pandas warns about performing this command, because <code class="docutils literal notranslate"><span class="pre">talk</span></code> is only a slice or a <em>view</em> into the DataFrame.</p>
<p>Assigning a new column to <strong>only a part of the DataFrame</strong> would cause problems by breaking the tabular structure.</p>
<p>We can fix the situation by creating a <em>deep copy</em> of the slice using Python’s <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a deep copy of the DataFrame</span>
<span class="n">talk</span> <span class="o">=</span> <span class="n">talk</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s try creating an empty column again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new column named &#39;processed_title&#39;</span>
<span class="n">talk</span><span class="p">[</span><span class="s1">&#39;processed_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the first five rows of the DataFrame</span>
<span class="n">talk</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
      <th>comments_ratio</th>
      <th>processed_title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>6929035</td>
      <td>Too many first nations people live in a dream ...</td>
      <td>http://www.theglobeandmail.com/opinion/too-man...</td>
      <td>Jeffrey Simpson</td>
      <td>2013-01-05 EST</td>
      <td>1164.0</td>
      <td>433.0</td>
      <td>&lt;p&gt;Large elements of aboriginal Canada live in...</td>
      <td>0.371993</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11672346</td>
      <td>Disgruntled Arab states look to strip Canada o...</td>
      <td>http://www.theglobeandmail.com/news/world/disg...</td>
      <td>Campbell Clark</td>
      <td>2013-05-02 EDT</td>
      <td>1129.0</td>
      <td>411.0</td>
      <td>&lt;p&gt;Growing discontent among Arab nations over ...</td>
      <td>0.364039</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26691065</td>
      <td>Fifty years in Canada, and now I feel like a s...</td>
      <td>http://www.theglobeandmail.com/opinion/fifty-y...</td>
      <td>SHEEMA KHAN</td>
      <td>2015-10-07 EDT</td>
      <td>1142.0</td>
      <td>376.0</td>
      <td>&lt;p&gt;'Too broken to write,' I told my editor, af...</td>
      <td>0.329247</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>25731634</td>
      <td>I'm Canadian - and I should have a right to vote</td>
      <td>http://www.theglobeandmail.com/opinion/im-cana...</td>
      <td>Donald Sutherland</td>
      <td>2015-07-28 EDT</td>
      <td>1021.0</td>
      <td>348.0</td>
      <td>&lt;p&gt;My name is Donald Sutherland. My wife's nam...</td>
      <td>0.340842</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>13647608</td>
      <td>A nation of $100,000 firefighters</td>
      <td>http://www.theglobeandmail.com/opinion/a-natio...</td>
      <td>Margaret Wente</td>
      <td>2013-08-08 EDT</td>
      <td>1102.0</td>
      <td>338.0</td>
      <td>&lt;p&gt;Everyone loves firefighters. They save live...</td>
      <td>0.306715</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To retrieve the title for each article from the column <code class="docutils literal notranslate"><span class="pre">title</span></code>, feed it to the language model under <code class="docutils literal notranslate"><span class="pre">nlp</span></code> for processing and store the output into the column <code class="docutils literal notranslate"><span class="pre">processed_title</span></code>, we need to use the <code class="docutils literal notranslate"><span class="pre">apply()</span></code> method of a DataFrame.</p>
<p>As the name suggests, the <code class="docutils literal notranslate"><span class="pre">apply()</span></code> method applies whatever is provided as input to the method to each row in the column.</p>
<p>In this case, we pass the language model <code class="docutils literal notranslate"><span class="pre">nlp</span></code> to the <code class="docutils literal notranslate"><span class="pre">apply()</span></code> method, essentially retrieving the titles stored as string objects in the column <code class="docutils literal notranslate"><span class="pre">title</span></code> and “applying” the language model <code class="docutils literal notranslate"><span class="pre">nlp</span></code> to them.</p>
<p>We assign the output to the DataFrame column named <code class="docutils literal notranslate"><span class="pre">processed_title</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the language model under &#39;nlp&#39; to the contents of the DataFrame column &#39;title&#39;</span>
<span class="n">talk</span><span class="p">[</span><span class="s1">&#39;processed_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talk</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span>

<span class="c1"># Call the variable to check the output</span>
<span class="n">talk</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
      <th>comments_ratio</th>
      <th>processed_title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>6929035</td>
      <td>Too many first nations people live in a dream ...</td>
      <td>http://www.theglobeandmail.com/opinion/too-man...</td>
      <td>Jeffrey Simpson</td>
      <td>2013-01-05 EST</td>
      <td>1164.0</td>
      <td>433.0</td>
      <td>&lt;p&gt;Large elements of aboriginal Canada live in...</td>
      <td>0.371993</td>
      <td>(Too, many, first, nations, people, live, in, ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11672346</td>
      <td>Disgruntled Arab states look to strip Canada o...</td>
      <td>http://www.theglobeandmail.com/news/world/disg...</td>
      <td>Campbell Clark</td>
      <td>2013-05-02 EDT</td>
      <td>1129.0</td>
      <td>411.0</td>
      <td>&lt;p&gt;Growing discontent among Arab nations over ...</td>
      <td>0.364039</td>
      <td>(Disgruntled, Arab, states, look, to, strip, C...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26691065</td>
      <td>Fifty years in Canada, and now I feel like a s...</td>
      <td>http://www.theglobeandmail.com/opinion/fifty-y...</td>
      <td>SHEEMA KHAN</td>
      <td>2015-10-07 EDT</td>
      <td>1142.0</td>
      <td>376.0</td>
      <td>&lt;p&gt;'Too broken to write,' I told my editor, af...</td>
      <td>0.329247</td>
      <td>(Fifty, years, in, Canada, ,, and, now, I, fee...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>25731634</td>
      <td>I'm Canadian - and I should have a right to vote</td>
      <td>http://www.theglobeandmail.com/opinion/im-cana...</td>
      <td>Donald Sutherland</td>
      <td>2015-07-28 EDT</td>
      <td>1021.0</td>
      <td>348.0</td>
      <td>&lt;p&gt;My name is Donald Sutherland. My wife's nam...</td>
      <td>0.340842</td>
      <td>(I, 'm, Canadian, -, and, I, should, have, a, ...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>13647608</td>
      <td>A nation of $100,000 firefighters</td>
      <td>http://www.theglobeandmail.com/opinion/a-natio...</td>
      <td>Margaret Wente</td>
      <td>2013-08-08 EDT</td>
      <td>1102.0</td>
      <td>338.0</td>
      <td>&lt;p&gt;Everyone loves firefighters. They save live...</td>
      <td>0.306715</td>
      <td>(A, nation, of, $, 100,000, firefighters)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1694</th>
      <td>30474884</td>
      <td>A dangerous moment in history: Can the politic...</td>
      <td>http://www.theglobeandmail.com/opinion/can-the...</td>
      <td>Konrad Yakabuski</td>
      <td>2016-06-16 EDT</td>
      <td>239.0</td>
      <td>50.0</td>
      <td>&lt;p&gt;As anyone trying to maintain perspective wh...</td>
      <td>0.209205</td>
      <td>(A, dangerous, moment, in, history, :, Can, th...</td>
    </tr>
    <tr>
      <th>1735</th>
      <td>32088785</td>
      <td>Clinton shines in first debate, and not just i...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2016-09-27 EDT</td>
      <td>232.0</td>
      <td>49.0</td>
      <td>&lt;p&gt;For those who wondered whether Hillary Clin...</td>
      <td>0.211207</td>
      <td>(Clinton, shines, in, first, debate, ,, and, n...</td>
    </tr>
    <tr>
      <th>2213</th>
      <td>30508530</td>
      <td>U.S. gun control: Don't look for logic after O...</td>
      <td>http://www.theglobeandmail.com/opinion/us-gun-...</td>
      <td>Konrad Yakabuski</td>
      <td>2016-06-20 EDT</td>
      <td>243.0</td>
      <td>40.0</td>
      <td>&lt;p&gt;The script is by now tediously formulaic. A...</td>
      <td>0.164609</td>
      <td>(U.S., gun, control, :, Do, n't, look, for, lo...</td>
    </tr>
    <tr>
      <th>2301</th>
      <td>31605288</td>
      <td>Let's make sure Ontario's sex-ed curriculum is...</td>
      <td>http://www.theglobeandmail.com/opinion/lets-ma...</td>
      <td>DEBRA SOH</td>
      <td>2016-08-30 EDT</td>
      <td>239.0</td>
      <td>39.0</td>
      <td>&lt;p&gt;Debra W. Soh is a sex writer and sexual neu...</td>
      <td>0.163180</td>
      <td>(Let, 's, make, sure, Ontario, 's, sex, -, ed,...</td>
    </tr>
    <tr>
      <th>2302</th>
      <td>24363093</td>
      <td>Dad rules when sex ed collides with religion</td>
      <td>http://www.theglobeandmail.com/opinion/dad-rul...</td>
      <td>MICHAEL ADAMS</td>
      <td>2015-05-11 EDT</td>
      <td>222.0</td>
      <td>39.0</td>
      <td>&lt;p&gt;Michael Adams is founder and president of t...</td>
      <td>0.175676</td>
      <td>(Dad, rules, when, sex, ed, collides, with, re...</td>
    </tr>
  </tbody>
</table>
<p>519 rows × 10 columns</p>
</div></div></div>
</div>
<p>We now have the processed titles in a separate column named <code class="docutils literal notranslate"><span class="pre">processed_title</span></code>!</p>
<p>Let’s examine the first row in the DataFrame <code class="docutils literal notranslate"><span class="pre">talk</span></code>, whose index is 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the value in the column &#39;processed_title&#39; at row with index 2</span>
<span class="n">talk</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;processed_title&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Too many first nations people live in a dream palace
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the type of the contained object</span>
<span class="nb">type</span><span class="p">(</span><span class="n">talk</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;processed_title&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>spacy.tokens.doc.Doc
</pre></div>
</div>
</div>
</div>
<p>As you can see, the cell contains a spaCy <em>Doc</em> object.</p>
<p>Let’s now define our own Python <strong>function</strong> to fetch lemmas for each noun in the title.</p>
<p>Python functions are <em>defined</em> using the command <code class="docutils literal notranslate"><span class="pre">def</span></code>, which is followed by the name of the function, in this case <code class="docutils literal notranslate"><span class="pre">get_nouns</span></code>.</p>
<p>The input to the function is given in parentheses that follow the name of the function.</p>
<p>In this case, we name a variable for the input called <code class="docutils literal notranslate"><span class="pre">nlp_text</span></code>. This is an arbitrary variable, which is needed for referring to whatever is being provided as input to the function. To put it simply, you can think of this variable as referring to any input that will be eventually provided to the function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function named &#39;get_nouns&#39; that takes a single object as input.</span>
<span class="c1"># We refer to this input using the variable name &#39;nlp_text&#39;.</span>
<span class="k">def</span> <span class="nf">get_nouns</span><span class="p">(</span><span class="n">nlp_text</span><span class="p">):</span>
    
    <span class="c1"># First we make sure that the input is of correct type</span>
    <span class="c1"># by using the assert command to check the input type</span>
    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">nlp_text</span><span class="p">)</span> <span class="o">==</span> <span class="n">spacy</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">Doc</span>
    
    <span class="c1"># Let&#39;s set up a placeholder list for our lemmas</span>
    <span class="n">lemmas</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># We begin then begin looping over the Doc object</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">nlp_text</span><span class="p">:</span>
        
        <span class="c1"># If the fine-grained POS tag for the token is a noun (NN)</span>
        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">tag_</span> <span class="o">==</span> <span class="s1">&#39;NN&#39;</span><span class="p">:</span>
            
            <span class="c1"># Append the token lemma to the list of lemmas</span>
            <span class="n">lemmas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">lemma_</span><span class="p">)</span>
            
    <span class="c1"># When the loop is complete, return the list of lemmas</span>
    <span class="k">return</span> <span class="n">lemmas</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have defined our function, we can use the function with the <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> method to collect all nouns to the column <code class="docutils literal notranslate"><span class="pre">nouns</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the &#39;get_nouns&#39; function to the column &#39;processed_title&#39;</span>
<span class="n">talk</span><span class="p">[</span><span class="s1">&#39;nouns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">talk</span><span class="p">[</span><span class="s1">&#39;processed_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_nouns</span><span class="p">)</span>

<span class="c1"># Call the variable to examine the output</span>
<span class="n">talk</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>article_id</th>
      <th>title</th>
      <th>article_url</th>
      <th>author</th>
      <th>published_date</th>
      <th>ncomments</th>
      <th>ntop_level_comments</th>
      <th>article_text</th>
      <th>comments_ratio</th>
      <th>processed_title</th>
      <th>nouns</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>6929035</td>
      <td>Too many first nations people live in a dream ...</td>
      <td>http://www.theglobeandmail.com/opinion/too-man...</td>
      <td>Jeffrey Simpson</td>
      <td>2013-01-05 EST</td>
      <td>1164.0</td>
      <td>433.0</td>
      <td>&lt;p&gt;Large elements of aboriginal Canada live in...</td>
      <td>0.371993</td>
      <td>(Too, many, first, nations, people, live, in, ...</td>
      <td>[dream, palace]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11672346</td>
      <td>Disgruntled Arab states look to strip Canada o...</td>
      <td>http://www.theglobeandmail.com/news/world/disg...</td>
      <td>Campbell Clark</td>
      <td>2013-05-02 EDT</td>
      <td>1129.0</td>
      <td>411.0</td>
      <td>&lt;p&gt;Growing discontent among Arab nations over ...</td>
      <td>0.364039</td>
      <td>(Disgruntled, Arab, states, look, to, strip, C...</td>
      <td>[agency]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>26691065</td>
      <td>Fifty years in Canada, and now I feel like a s...</td>
      <td>http://www.theglobeandmail.com/opinion/fifty-y...</td>
      <td>SHEEMA KHAN</td>
      <td>2015-10-07 EDT</td>
      <td>1142.0</td>
      <td>376.0</td>
      <td>&lt;p&gt;'Too broken to write,' I told my editor, af...</td>
      <td>0.329247</td>
      <td>(Fifty, years, in, Canada, ,, and, now, I, fee...</td>
      <td>[class, citizen]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>25731634</td>
      <td>I'm Canadian - and I should have a right to vote</td>
      <td>http://www.theglobeandmail.com/opinion/im-cana...</td>
      <td>Donald Sutherland</td>
      <td>2015-07-28 EDT</td>
      <td>1021.0</td>
      <td>348.0</td>
      <td>&lt;p&gt;My name is Donald Sutherland. My wife's nam...</td>
      <td>0.340842</td>
      <td>(I, 'm, Canadian, -, and, I, should, have, a, ...</td>
      <td>[right]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>13647608</td>
      <td>A nation of $100,000 firefighters</td>
      <td>http://www.theglobeandmail.com/opinion/a-natio...</td>
      <td>Margaret Wente</td>
      <td>2013-08-08 EDT</td>
      <td>1102.0</td>
      <td>338.0</td>
      <td>&lt;p&gt;Everyone loves firefighters. They save live...</td>
      <td>0.306715</td>
      <td>(A, nation, of, $, 100,000, firefighters)</td>
      <td>[nation]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1694</th>
      <td>30474884</td>
      <td>A dangerous moment in history: Can the politic...</td>
      <td>http://www.theglobeandmail.com/opinion/can-the...</td>
      <td>Konrad Yakabuski</td>
      <td>2016-06-16 EDT</td>
      <td>239.0</td>
      <td>50.0</td>
      <td>&lt;p&gt;As anyone trying to maintain perspective wh...</td>
      <td>0.209205</td>
      <td>(A, dangerous, moment, in, history, :, Can, th...</td>
      <td>[moment, history, centre, hold]</td>
    </tr>
    <tr>
      <th>1735</th>
      <td>32088785</td>
      <td>Clinton shines in first debate, and not just i...</td>
      <td>http://www.theglobeandmail.com/opinion/editori...</td>
      <td>GLOBE EDITORIAL</td>
      <td>2016-09-27 EDT</td>
      <td>232.0</td>
      <td>49.0</td>
      <td>&lt;p&gt;For those who wondered whether Hillary Clin...</td>
      <td>0.211207</td>
      <td>(Clinton, shines, in, first, debate, ,, and, n...</td>
      <td>[debate, comparison]</td>
    </tr>
    <tr>
      <th>2213</th>
      <td>30508530</td>
      <td>U.S. gun control: Don't look for logic after O...</td>
      <td>http://www.theglobeandmail.com/opinion/us-gun-...</td>
      <td>Konrad Yakabuski</td>
      <td>2016-06-20 EDT</td>
      <td>243.0</td>
      <td>40.0</td>
      <td>&lt;p&gt;The script is by now tediously formulaic. A...</td>
      <td>0.164609</td>
      <td>(U.S., gun, control, :, Do, n't, look, for, lo...</td>
      <td>[gun, control, logic]</td>
    </tr>
    <tr>
      <th>2301</th>
      <td>31605288</td>
      <td>Let's make sure Ontario's sex-ed curriculum is...</td>
      <td>http://www.theglobeandmail.com/opinion/lets-ma...</td>
      <td>DEBRA SOH</td>
      <td>2016-08-30 EDT</td>
      <td>239.0</td>
      <td>39.0</td>
      <td>&lt;p&gt;Debra W. Soh is a sex writer and sexual neu...</td>
      <td>0.163180</td>
      <td>(Let, 's, make, sure, Ontario, 's, sex, -, ed,...</td>
      <td>[sex, ed, curriculum]</td>
    </tr>
    <tr>
      <th>2302</th>
      <td>24363093</td>
      <td>Dad rules when sex ed collides with religion</td>
      <td>http://www.theglobeandmail.com/opinion/dad-rul...</td>
      <td>MICHAEL ADAMS</td>
      <td>2015-05-11 EDT</td>
      <td>222.0</td>
      <td>39.0</td>
      <td>&lt;p&gt;Michael Adams is founder and president of t...</td>
      <td>0.175676</td>
      <td>(Dad, rules, when, sex, ed, collides, with, re...</td>
      <td>[sex, religion]</td>
    </tr>
  </tbody>
</table>
<p>519 rows × 11 columns</p>
</div></div></div>
</div>
<p>As you can see, an empty DataFrame column is actually not required for adding new data, because pandas creates a new column automatically through assignment, as exemplified by <code class="docutils literal notranslate"><span class="pre">talk['nouns']</span></code>.</p>
<p>We can also easily extract information from DataFrames into Python’s native data structures.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">tolist()</span></code> method, for instance, can be used to extract the contents of a <em>pandas</em> Series into a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cast pandas Series to a list</span>
<span class="n">noun_list</span> <span class="o">=</span> <span class="n">talk</span><span class="p">[</span><span class="s1">&#39;nouns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Call the variable to check the output</span>
<span class="n">noun_list</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;dream&#39;, &#39;palace&#39;],
 [&#39;agency&#39;],
 [&#39;class&#39;, &#39;citizen&#39;],
 [&#39;right&#39;],
 [&#39;nation&#39;],
 [],
 [&#39;reform&#39;],
 [&#39;leader&#39;, &#39;parade&#39;],
 [&#39;pm&#39;],
 [&#39;government&#39;, &#39;monopoly&#39;]]
</pre></div>
</div>
</div>
</div>
<p>What we have now under <code class="docutils literal notranslate"><span class="pre">noun_list</span></code> is a list of lists, because each row in the <code class="docutils literal notranslate"><span class="pre">nouns</span></code> column contains a list.</p>
<p>Let’s loop over the list and collect the items into a single list named <code class="docutils literal notranslate"><span class="pre">final_list</span></code> using the <code class="docutils literal notranslate"><span class="pre">extend()</span></code> method of a Python list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the placeholder list</span>
<span class="n">final_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop over each list in the list of lists</span>
<span class="k">for</span> <span class="n">nlist</span> <span class="ow">in</span> <span class="n">noun_list</span><span class="p">:</span>
    
    <span class="c1"># Extend the final list with the current list</span>
    <span class="n">final_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nlist</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s briefly examine the first ten items in final list and then count the number of items in the list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the first ten items in the list</span>
<span class="n">final_list</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;dream&#39;,
 &#39;palace&#39;,
 &#39;agency&#39;,
 &#39;class&#39;,
 &#39;citizen&#39;,
 &#39;right&#39;,
 &#39;nation&#39;,
 &#39;reform&#39;,
 &#39;leader&#39;,
 &#39;parade&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the length of the list</span>
<span class="nb">len</span><span class="p">(</span><span class="n">final_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>884
</pre></div>
</div>
</div>
</div>
<p>To plot the 10 most frequent nouns, we can cast the <code class="docutils literal notranslate"><span class="pre">final_list</span></code> into a pandas Series, count the occurrences of each lemma using <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> and plot the result using the <code class="docutils literal notranslate"><span class="pre">plot()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the list into a pandas Series, count unique nouns</span>
<span class="c1"># using the value_counts() method, get the 10 most frequent</span>
<span class="c1"># items [:10] and plot the result into a bar chart using the</span>
<span class="c1"># plot() method and its attribute &#39;kind&#39;.</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">final_list</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: &gt;
</pre></div>
</div>
<img alt="../../_images/30ec8bd0edab6aa1bb188cb482c335edd4d01c07313741a103ccadced182babc.png" src="../../_images/30ec8bd0edab6aa1bb188cb482c335edd4d01c07313741a103ccadced182babc.png" />
</div>
</div>
</section>
<section id="saving-dataframes">
<h2>Saving DataFrames<a class="headerlink" href="#saving-dataframes" title="Permalink to this headline">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="600"
            height="350"
            src="https://www.youtube.com/embed/yK_3QgOVXIo"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<p>pandas DataFrames can be easily saved as <em>pickled</em> objects using the <code class="docutils literal notranslate"><span class="pre">to_pickle()</span></code> method.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">to_pickle()</span></code> method takes a string as input, which defines a path to the file in which the DataFrame should be written.</p>
<p>Let’s pickle the DataFrame with the three articles stored under <code class="docutils literal notranslate"><span class="pre">df</span></code> into a file named <code class="docutils literal notranslate"><span class="pre">pickled_df.pkl</span></code> into the directory <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write the DataFrame to disk using pickle</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;data/pickled_df.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can easily check if the data has been saved successfully by reading the file contents using the <code class="docutils literal notranslate"><span class="pre">read_pickle()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the pickled DataFrame and assign the result to &#39;df_2&#39;</span>
<span class="n">df_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;data/pickled_df.pkl&#39;</span><span class="p">)</span>

<span class="c1"># Call the variable to examine the output</span>
<span class="n">df_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>WP_1990-08-10-25A.txt</td>
      <td>﻿*We Don’t Stand for Bullies': Diverse Voices ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NYT_1991-01-16-A15.txt</td>
      <td>﻿U.S. TAKING STEPS TO CURB TERRORISM: F.B.I. I...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WP_1991-01-17-A1B.txt</td>
      <td>﻿U.S., Allies Launch Massive Air War Against T...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s compare the DataFrames, which returns a Boolean value (True/False) for each cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare DataFrames &#39;df&#39; and &#39;df_2&#39;</span>
<span class="n">df</span> <span class="o">==</span> <span class="n">df_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This section should have given you a basic idea of the <em>pandas</em> library and how DataFrames can be used to store and manipulate textual data.</p>
<p>In <a class="reference internal" href="../part_iii/01_multilingual_nlp.html"><span class="doc std std-doc">Part III</span></a>, you will learn more about natural language processing techniques and their applications.</p>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="05_evaluating_nlp.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Evaluating language models</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../nlp_for_linguists.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part III: Natural Language Processing for Linguists</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


   <div class="footer"><a href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0;padding:10px" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-nc.svg"/></a> © 2020– <a href="http://www.helsinki.fi/~thiippal">Tuomo Hiippala</a>
       in collaboration with <a href="https://mooc.fi/en" target="_blank">mooc.fi<img src="https://applied-language-technology.mooc.fi/html/_static/moocfi.svg" style="border-width:0;padding:2px" width=50></a></div>
    

  </body>
</html>